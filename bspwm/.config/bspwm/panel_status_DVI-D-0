#! /bin/sh

source $(dirname $0)/panel_config

datetime() {
    echo "%{F#FF$WHITE_COLOR}date %{F}$(date +'%A, %b %d')  %{B#FF$RED_COLOR}  $(date +'%H:%M')  %{B-}"
}

temperature() {
    CPU_TEMP=$(sensors | grep "Core 0" | cut -d+ -f2 | cut -d. -f1)
    echo "%{F#FF$WHITE_COLOR}temp %{F}$CPU_TEMPÂ°C"
}

load_avg() {
    AVGLOAD=$(cut -d " " -f 1-3 /proc/loadavg)
    echo "%{F#FF$WHITE_COLOR}load %{F}$AVGLOAD"
}

syncthing() {
    SYNC_STATUS=$(systemctl status syncthing@mfin | grep active | cut -d: -f 2 | cut -d " " -f 2)
    echo "%{F#FF$WHITE_COLOR}sync %{F}$SYNC_STATUS"
}

while :; do
    echo "S%{r}$(load_avg) $SEP $(temperature) $SEP $(syncthing) $SEP $(datetime)"
    sleep 2
done
